<div class="container">
  <div class="sidebar">
    <h2>  My Medications </h2>
    <div class="medicine-list" id="medicineList">
      {{#each user.medicine}}
      <div class="medicine-item">
        <h3>{{medicationName}}</h3>
        <div class="medicine-details">
          <div>Dosage: {{dosage}}mg</div>
          <div>Form: {{dosageForm}}</div>
          <div>Frequency: {{frequency}}</div>
          <button onclick="removeMedication('{{_id}}')" class="remove-btn">Remove</button>
        </div>
      </div>
      {{/each}}
    </div>
    <div class="add-medicine-form">
      <h3>Add New Medication</h3>
      <form id="addMedicineForm">
        <div class="form-group">
          <label for="medicationName">Medication Name</label>
          <input type="text" id="medicationName" name="medicationName" required>
        </div>
        <div class="form-group">
          <label for="dosage">Dosage (tablets/dose)</label>
          <input type="number" id="dosage" name="dosage" required min="1" step="0.5">
        </div>
        <div class="form-group">
          <label for="dosageForm">Dosage Form</label>
          <select id="dosageForm" name="dosageForm" required>
            <option value="">Select form</option>
            <option value="tablet">Tablet</option>
            <option value="capsule">Capsule</option>
            <option value="liquid">Liquid</option>
            <option value="injection">Injection</option>
          </select>
        </div>
        <div class="form-group">
          <label for="totalDoses">Total Number of Doses</label>
          <input type="number" id="totalDoses" name="totalDoses" required min="1">
        </div>
        <div class="form-group">
          <label for="frequency">Frequency</label>
          <div class="frequency-inputs">
            <input type="number" id="frequencyNumber" name="frequencyNumber" required min="1">
            <select id="frequencyUnit" name="frequencyUnit" required>
              <option value="">Select unit</option>
              <option value="hour">Hour(s)</option>
              <option value="day">Day(s)</option>
              <option value="week">Week(s)</option>
              <option value="month">Month(s)</option>
            </select>
          </div>
        </div>
        <button type="submit" class="add-btn">Add Medication</button>
      </form>
      <div id="errorMessage" class="error-message"></div>
    </div>
  </div>
  <div class="main-content">
    <div class="header">
      <h1>Hi {{user.firstName}}</h1>
      <a href="/logout" class="logout-btn">Logout</a>
    </div>
    <div class="voice-assistant">
      <h2>Ollama Voice Assistant</h2>
      <div id="statusMessage" class="status not-listening">
        Microphone is inactive
      </div>
      <button id="toggleButton" class="inactive">Start Listening</button>
      <div class="transcript-container" id="conversationContainer">
        {{#each conversationMessages}}
        <div class="message {{this.role}}-message">
          {{this.content}}
        </div>
        {{/each}}
      </div>
    </div>
    <br>
    <br>
    <button class="memory-journal-btn" onclick="window.location.href='/journal'">Memory Journal</button>
  </div>
</div>

<script src="/public/js/voice-assistant.js"></script>
<script src="/public/js/medicine-management.js"></script>
<script src="/public/js/medication.js"></script>
<script>
if ('webkitSpeechRecognition' in window) {
    new webkitSpeechRecognition();
}
</script>